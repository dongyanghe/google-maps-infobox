/* An InfoBox is like an info window, but it displays
 * under the marker, opens quicker, and has flexible styling.
 * @param {GLatLng} latlng Point to place bar at
 * @param {Map} map The map on which to display this InfoBox.
 * @param {Object} opts Passes configuration options - content,
 * offsetVertical, offsetHorizontal, className, height, width
 *
 * credit: http://codepen.io/emgerold/pen/kjivC
 */
function InfoBox(a){google.maps.OverlayView.call(this),this.id=a.id,this.latlng_=a.latlng,this.map_=a.map,this.content=a.content,this.offsetVertical_=-195,this.offsetHorizontal_=5,this.height_=165,this.width_=266;var b=this;this.boundsChangedListener_=google.maps.event.addListener(this.map_,"bounds_changed",function(){return b.panMap.apply(b)}),this.setMap(this.map_)}InfoBox.prototype=new google.maps.OverlayView,InfoBox.prototype.remove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},InfoBox.prototype.draw=function(){if(this.createElement(),this.div_){var a=this.getProjection().fromLatLngToDivPixel(this.latlng_);a&&(this.div_.style.width=this.width_+"px",this.div_.style.left=a.x+this.offsetHorizontal_+"px",this.div_.style.height=this.height_+"px",this.div_.style.top=a.y+this.offsetVertical_+"px",this.div_.style.display="block")}},InfoBox.prototype.createElement=function(){function e(a){return function(){a.setMap(null)}}var a=this.getPanes(),b=this.div_;if(b)b.parentNode!=a.floatPane&&(b.parentNode.removeChild(b),a.floatPane.appendChild(b));else{b=this.div_=document.createElement("div"),b.className="infobox";var c=document.createElement("div");c.className="content",c.innerHTML=this.content;var d=document.createElement("div");d.className="close",d.innerHTML="x",b.appendChild(d),google.maps.event.addDomListener(d,"click",e(this)),b.appendChild(c),b.style.display="none",a.floatPane.appendChild(b),this.panMap()}},InfoBox.prototype.panMap=function(){var a=this.map_,b=a.getBounds();if(b){var c=this.latlng_,d=this.width_,e=this.height_,f=this.offsetHorizontal_,g=this.offsetVertical_,h=40,i=40,j=a.getDiv(),k=j.offsetWidth,l=j.offsetHeight,m=b.toSpan(),n=m.lng(),o=m.lat(),p=n/k,q=o/l,r=b.getSouthWest().lng(),s=b.getNorthEast().lng(),t=b.getNorthEast().lat(),u=b.getSouthWest().lat(),v=c.lng()+(f-h)*p,w=c.lng()+(f+d+h)*p,x=c.lat()-(g-i)*q,y=c.lat()-(g+e+i)*q,z=(v<r?r-v:0)+(w>s?s-w:0),A=(x>t?t-x:0)+(y<u?u-y:0),B=a.getCenter(),C=B.lng()-z,D=B.lat()-A;a.setCenter(new google.maps.LatLng(D,C)),google.maps.event.removeListener(this.boundsChangedListener_),this.boundsChangedListener_=null}};